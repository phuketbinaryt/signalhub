//@version=5
indicator("Bearish FVG Test", overlay=true)

// Simple bearish FVG detection
// Look for: candle[2] low > candle[0] high (gap down)
gap = low[2] > high
gapSize = gap ? low[2] - high : 0

// Visualize all potential gaps
bgcolor(gap ? color.new(color.red, 90) : na)

// Plot gap info
if gap
    label.new(bar_index, high, "GAP\n" + str.tostring(gapSize, "#.####"), color=color.red, style=label.style_label_up, size=size.small)
    
    // Draw box for the gap
    box.new(bar_index - 2, low[2], bar_index, high, border_color=color.red, border_width=1, bgcolor=color.new(color.red, 80))

// Show current values for debugging
var table debugTable = table.new(position.top_right, 1, 4)
if barstate.islast
    table.cell(debugTable, 0, 0, "Candle[2] Low: " + str.tostring(low[2], "#.####"), bgcolor=color.new(color.blue, 80))
    table.cell(debugTable, 0, 1, "Candle[1] H/L: " + str.tostring(high[1], "#.####") + " / " + str.tostring(low[1], "#.####"), bgcolor=color.new(color.blue, 80))
    table.cell(debugTable, 0, 2, "Candle[0] High: " + str.tostring(high, "#.####"), bgcolor=color.new(color.blue, 80))
    table.cell(debugTable, 0, 3, "Gap Exists: " + str.tostring(gap), bgcolor=gap ? color.new(color.green, 80) : color.new(color.red, 80))